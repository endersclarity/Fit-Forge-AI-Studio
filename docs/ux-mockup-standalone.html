<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FitForge UX Mockup - Standalone Demo</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Framer Motion -->
  <script src="https://unpkg.com/framer-motion@11/dist/framer-motion.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    * {
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    /* Drawer overlay */
    .drawer-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.4);
      z-index: 40;
    }

    .drawer-content {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-top-left-radius: 24px;
      border-top-right-radius: 24px;
      height: 80vh;
      margin-top: 24px;
      z-index: 50;
      display: flex;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useCallback } = React;
    const { motion, AnimatePresence } = window.framerMotion;

    // ==================== MOCK DATA ====================
    const mockWorkout = [
      {
        id: 'ex-1',
        name: 'Barbell Bench Press',
        equipment: 'Barbell',
        muscleGroups: ['Chest', 'Triceps', 'Shoulders'],
        restTimerSeconds: 90,
        sets: [
          { id: 'set-1-1', reps: 10, weight: 135, completed: false, toFailure: false },
          { id: 'set-1-2', reps: 10, weight: 135, completed: false, toFailure: false },
          { id: 'set-1-3', reps: 10, weight: 135, completed: false, toFailure: false },
        ],
      },
      {
        id: 'ex-2',
        name: 'Barbell Squat',
        equipment: 'Barbell',
        muscleGroups: ['Quads', 'Glutes', 'Hamstrings'],
        restTimerSeconds: 120,
        sets: [
          { id: 'set-2-1', reps: 8, weight: 185, completed: false, toFailure: false },
          { id: 'set-2-2', reps: 8, weight: 185, completed: false, toFailure: false },
          { id: 'set-2-3', reps: 8, weight: 185, completed: false, toFailure: false },
        ],
      },
      {
        id: 'ex-3',
        name: 'Barbell Row',
        equipment: 'Barbell',
        muscleGroups: ['Back', 'Biceps'],
        restTimerSeconds: 90,
        sets: [
          { id: 'set-3-1', reps: 12, weight: 95, completed: false, toFailure: false },
          { id: 'set-3-2', reps: 12, weight: 95, completed: false, toFailure: false },
          { id: 'set-3-3', reps: 12, weight: 95, completed: false, toFailure: false },
        ],
      },
      {
        id: 'ex-4',
        name: 'Overhead Press',
        equipment: 'Barbell',
        muscleGroups: ['Shoulders', 'Triceps'],
        restTimerSeconds: 90,
        sets: [
          { id: 'set-4-1', reps: 10, weight: 75, completed: false, toFailure: false },
          { id: 'set-4-2', reps: 10, weight: 75, completed: false, toFailure: false },
          { id: 'set-4-3', reps: 10, weight: 75, completed: false, toFailure: false },
        ],
      },
    ];

    const exerciseLibrary = [
      // Push exercises
      { id: 'ex-bench', name: 'Barbell Bench Press', equipment: 'Barbell', muscleGroups: ['Chest', 'Triceps'], category: 'Push' },
      { id: 'ex-incline', name: 'Incline Dumbbell Press', equipment: 'Dumbbells', muscleGroups: ['Chest', 'Shoulders'], category: 'Push' },
      { id: 'ex-ohp', name: 'Overhead Press', equipment: 'Barbell', muscleGroups: ['Shoulders', 'Triceps'], category: 'Push' },
      { id: 'ex-dips', name: 'Dips', equipment: 'Bodyweight', muscleGroups: ['Chest', 'Triceps'], category: 'Push' },
      { id: 'ex-pushups', name: 'Push-Ups', equipment: 'Bodyweight', muscleGroups: ['Chest', 'Triceps'], category: 'Push' },
      { id: 'ex-cable-fly', name: 'Cable Flyes', equipment: 'Cable', muscleGroups: ['Chest'], category: 'Push' },
      // Pull exercises
      { id: 'ex-row', name: 'Barbell Row', equipment: 'Barbell', muscleGroups: ['Back', 'Biceps'], category: 'Pull' },
      { id: 'ex-pullup', name: 'Pull-Ups', equipment: 'Bodyweight', muscleGroups: ['Back', 'Biceps'], category: 'Pull' },
      { id: 'ex-deadlift', name: 'Deadlift', equipment: 'Barbell', muscleGroups: ['Back', 'Hamstrings', 'Glutes'], category: 'Pull' },
      { id: 'ex-lat-pulldown', name: 'Lat Pulldown', equipment: 'Cable', muscleGroups: ['Back', 'Biceps'], category: 'Pull' },
      { id: 'ex-db-row', name: 'Dumbbell Row', equipment: 'Dumbbells', muscleGroups: ['Back', 'Biceps'], category: 'Pull' },
      { id: 'ex-face-pull', name: 'Face Pulls', equipment: 'Cable', muscleGroups: ['Rear Delts', 'Traps'], category: 'Pull' },
      // Legs exercises
      { id: 'ex-squat', name: 'Barbell Squat', equipment: 'Barbell', muscleGroups: ['Quads', 'Glutes'], category: 'Legs' },
      { id: 'ex-rdl', name: 'Romanian Deadlift', equipment: 'Barbell', muscleGroups: ['Hamstrings', 'Glutes'], category: 'Legs' },
      { id: 'ex-leg-press', name: 'Leg Press', equipment: 'Machine', muscleGroups: ['Quads', 'Glutes'], category: 'Legs' },
      { id: 'ex-lunges', name: 'Walking Lunges', equipment: 'Dumbbells', muscleGroups: ['Quads', 'Glutes'], category: 'Legs' },
      { id: 'ex-leg-curl', name: 'Leg Curl', equipment: 'Machine', muscleGroups: ['Hamstrings'], category: 'Legs' },
      { id: 'ex-calf-raise', name: 'Calf Raises', equipment: 'Bodyweight', muscleGroups: ['Calves'], category: 'Legs' },
      // Core exercises
      { id: 'ex-plank', name: 'Plank', equipment: 'Bodyweight', muscleGroups: ['Core'], category: 'Core' },
      { id: 'ex-crunch', name: 'Crunches', equipment: 'Bodyweight', muscleGroups: ['Abs'], category: 'Core' },
      { id: 'ex-russian', name: 'Russian Twists', equipment: 'Dumbbells', muscleGroups: ['Obliques'], category: 'Core' },
      { id: 'ex-leg-raise', name: 'Hanging Leg Raises', equipment: 'Bodyweight', muscleGroups: ['Abs'], category: 'Core' },
      // Full Body
      { id: 'ex-burpees', name: 'Burpees', equipment: 'Bodyweight', muscleGroups: ['Full Body'], category: 'Full Body' },
      { id: 'ex-clean', name: 'Power Clean', equipment: 'Barbell', muscleGroups: ['Full Body'], category: 'Full Body' },
    ];

    // ==================== INLINE NUMBER PICKER ====================
    const InlineNumberPicker = ({ value, onChange, min = 0, max = 999, step = 1, unit = '' }) => {
      const increment = () => {
        if (value < max) {
          onChange(Math.min(max, value + step));
          if ('vibrate' in navigator) {
            navigator.vibrate(10);
          }
        }
      };

      const decrement = () => {
        if (value > min) {
          onChange(Math.max(min, value - step));
          if ('vibrate' in navigator) {
            navigator.vibrate(10);
          }
        }
      };

      return (
        <div className="flex items-center justify-center gap-4">
          <motion.button
            whileTap={{ scale: 0.95 }}
            onClick={decrement}
            disabled={value <= min}
            className="w-[60px] h-[60px] rounded-full bg-gray-200 flex items-center justify-center text-3xl font-bold active:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed shadow-md"
            aria-label={`Decrease ${unit}`}
          >
            −
          </motion.button>

          <div className="flex flex-col items-center min-w-[140px]">
            <AnimatePresence mode="wait">
              <motion.div
                key={value}
                initial={{ y: 10, opacity: 0 }}
                animate={{ y: 0, opacity: 1 }}
                exit={{ y: -10, opacity: 0 }}
                transition={{ type: "spring", stiffness: 400, damping: 30, duration: 0.15 }}
                className="text-6xl font-bold text-gray-900 tabular-nums"
              >
                {value}
              </motion.div>
            </AnimatePresence>
            {unit && (
              <span className="text-sm text-gray-500 uppercase tracking-wide mt-1">
                {unit}
              </span>
            )}
          </div>

          <motion.button
            whileTap={{ scale: 0.95 }}
            onClick={increment}
            disabled={value >= max}
            className="w-[60px] h-[60px] rounded-full bg-blue-600 flex items-center justify-center text-3xl font-bold text-white active:bg-blue-700 disabled:opacity-40 disabled:cursor-not-allowed shadow-lg"
            aria-label={`Increase ${unit}`}
            style={{ boxShadow: '0 4px 14px 0 rgba(37, 99, 235, 0.39)' }}
          >
            +
          </motion.button>
        </div>
      );
    };

    // ==================== REST TIMER ====================
    const RestTimer = ({ initialSeconds, onComplete, onSkip }) => {
      const [remaining, setRemaining] = useState(initialSeconds);

      useEffect(() => {
        setRemaining(initialSeconds);
      }, [initialSeconds]);

      useEffect(() => {
        if (remaining <= 0) {
          onComplete();
          return;
        }

        const timer = setInterval(() => {
          setRemaining((prev) => {
            if (prev <= 1) {
              if ('vibrate' in navigator) {
                navigator.vibrate([100, 50, 100]);
              }
              return 0;
            }
            return prev - 1;
          });
        }, 1000);

        return () => clearInterval(timer);
      }, [remaining, onComplete]);

      const minutes = Math.floor(remaining / 60);
      const seconds = remaining % 60;
      const progress = (remaining / initialSeconds) * 100;

      const handleAddTime = () => {
        setRemaining((prev) => prev + 15);
        if ('vibrate' in navigator) {
          navigator.vibrate(10);
        }
      };

      return (
        <AnimatePresence>
          <motion.div
            initial={{ y: -100, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            exit={{ y: -100, opacity: 0 }}
            transition={{ type: "spring", stiffness: 300, damping: 30 }}
            className="fixed top-4 left-4 right-4 bg-white rounded-2xl shadow-lg z-50 overflow-hidden"
            style={{ boxShadow: '0 10px 40px rgba(0, 0, 0, 0.15)' }}
          >
            <div className="p-4">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                    <svg className="w-5 h-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </div>
                  <div>
                    <div className="text-xs text-gray-500 uppercase tracking-wide font-medium">Rest Timer</div>
                    <motion.div
                      key={remaining}
                      initial={{ scale: 1.1 }}
                      animate={{ scale: 1 }}
                      className="text-3xl font-bold text-gray-900 tabular-nums"
                    >
                      {minutes}:{seconds.toString().padStart(2, '0')}
                    </motion.div>
                  </div>
                </div>

                <div className="flex items-center gap-2">
                  <motion.button
                    whileTap={{ scale: 0.95 }}
                    onClick={handleAddTime}
                    className="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-semibold text-gray-700 transition-colors"
                  >
                    +15s
                  </motion.button>
                  <motion.button
                    whileTap={{ scale: 0.95 }}
                    onClick={onSkip}
                    className="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm font-semibold text-white transition-colors shadow-md"
                  >
                    Skip
                  </motion.button>
                </div>
              </div>

              <div className="w-full h-1 bg-gray-200 rounded-full mt-3 overflow-hidden">
                <motion.div
                  className="h-full bg-blue-600 rounded-full"
                  initial={{ width: '100%' }}
                  animate={{ width: `${progress}%` }}
                  transition={{ duration: 0.3 }}
                />
              </div>
            </div>
          </motion.div>
        </AnimatePresence>
      );
    };

    // ==================== EXERCISE CARD ====================
    const ExerciseCard = ({ exercise, onUpdateSet, onLogSet, showLogAllButton, onLogAll }) => {
      const [expandedSetId, setExpandedSetId] = useState(null);

      const completedSets = exercise.sets.filter(s => s.completed).length;
      const totalSets = exercise.sets.length;

      return (
        <motion.div
          layout
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, x: -100 }}
          transition={{ type: "spring", stiffness: 300, damping: 30 }}
          className="mb-4"
        >
          <div className="bg-white rounded-2xl shadow-md overflow-hidden">
            <div className="p-4 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100">
              <div className="flex items-start justify-between">
                <div>
                  <h3 className="text-xl font-bold text-gray-900">{exercise.name}</h3>
                  <div className="flex items-center gap-2 mt-1">
                    <span className="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md">
                      {exercise.equipment}
                    </span>
                    {exercise.muscleGroups.map((muscle, idx) => (
                      <span key={idx} className="text-xs text-gray-500">
                        {muscle}
                      </span>
                    ))}
                  </div>
                </div>
                <div className="text-right">
                  <div className="text-2xl font-bold text-blue-600">{completedSets}/{totalSets}</div>
                  <div className="text-xs text-gray-500 uppercase tracking-wide">Sets</div>
                </div>
              </div>
            </div>

            <div className="p-4 space-y-3">
              {exercise.sets.map((set, index) => (
                <div key={set.id}>
                  <motion.div
                    layout
                    className={`rounded-xl border-2 overflow-hidden transition-all ${
                      set.completed
                        ? 'border-green-500 bg-green-50'
                        : expandedSetId === set.id
                        ? 'border-blue-500 bg-blue-50'
                        : 'border-gray-200 bg-white'
                    }`}
                  >
                    <motion.button
                      onClick={() => setExpandedSetId(expandedSetId === set.id ? null : set.id)}
                      className="w-full p-4 flex items-center justify-between text-left"
                      whileTap={{ scale: 0.98 }}
                    >
                      <div className="flex items-center gap-4">
                        <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${
                          set.completed ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700'
                        }`}>
                          {set.completed ? '✓' : index + 1}
                        </div>

                        <div className="flex items-center gap-2">
                          <span className="text-2xl font-bold text-gray-900">{set.weight}</span>
                          <span className="text-sm text-gray-500">lbs</span>
                          <span className="text-gray-400 mx-1">×</span>
                          <span className="text-2xl font-bold text-gray-900">{set.reps}</span>
                          <span className="text-sm text-gray-500">reps</span>
                        </div>
                      </div>

                      <motion.div
                        animate={{ rotate: expandedSetId === set.id ? 180 : 0 }}
                        transition={{ duration: 0.2 }}
                      >
                        <svg className="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                        </svg>
                      </motion.div>
                    </motion.button>

                    <AnimatePresence>
                      {expandedSetId === set.id && !set.completed && (
                        <motion.div
                          initial={{ height: 0, opacity: 0 }}
                          animate={{ height: "auto", opacity: 1 }}
                          exit={{ height: 0, opacity: 0 }}
                          transition={{ type: "spring", stiffness: 300, damping: 30 }}
                          className="border-t border-gray-200"
                        >
                          <div className="p-4 space-y-6">
                            <div>
                              <label className="block text-sm font-medium text-gray-700 mb-3">
                                Weight
                              </label>
                              <InlineNumberPicker
                                value={set.weight}
                                onChange={(val) => onUpdateSet(set.id, 'weight', val)}
                                min={0}
                                max={500}
                                step={5}
                                unit="lbs"
                              />
                            </div>

                            <div>
                              <label className="block text-sm font-medium text-gray-700 mb-3">
                                Reps
                              </label>
                              <InlineNumberPicker
                                value={set.reps}
                                onChange={(val) => onUpdateSet(set.id, 'reps', val)}
                                min={1}
                                max={50}
                                step={1}
                                unit="reps"
                              />
                            </div>

                            <div className="flex items-center justify-center gap-3">
                              <motion.button
                                whileTap={{ scale: 0.95 }}
                                onClick={() => onUpdateSet(set.id, 'toFailure', !set.toFailure)}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${
                                  set.toFailure
                                    ? 'bg-orange-100 text-orange-700'
                                    : 'bg-gray-100 text-gray-700'
                                }`}
                              >
                                <div className={`w-5 h-5 rounded border-2 flex items-center justify-center ${
                                  set.toFailure ? 'border-orange-500 bg-orange-500' : 'border-gray-400'
                                }`}>
                                  {set.toFailure && (
                                    <svg className="w-3 h-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" />
                                    </svg>
                                  )}
                                </div>
                                <span className="text-sm font-semibold">To Failure</span>
                              </motion.button>
                            </div>

                            <motion.button
                              whileTap={{ scale: 0.98 }}
                              onClick={() => onLogSet(set.id)}
                              className="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-lg transition-colors"
                              style={{ boxShadow: '0 4px 14px 0 rgba(37, 99, 235, 0.39)' }}
                            >
                              Log Set
                            </motion.button>
                          </div>
                        </motion.div>
                      )}
                    </AnimatePresence>
                  </motion.div>
                </div>
              ))}

              {showLogAllButton && (
                <motion.div
                  initial={{ opacity: 0, y: 10 }}
                  animate={{ opacity: 1, y: 0 }}
                  className="mt-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl"
                >
                  <p className="text-sm text-blue-900 mb-2 text-center">
                    Same weight/reps for remaining sets?
                  </p>
                  <motion.button
                    whileTap={{ scale: 0.98 }}
                    onClick={onLogAll}
                    className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors shadow-md"
                  >
                    Log All Remaining Sets
                  </motion.button>
                </motion.div>
              )}
            </div>
          </div>
        </motion.div>
      );
    };

    // ==================== EXERCISE PICKER ====================
    const ExercisePicker = ({ isOpen, onClose, exercises, onSelectExercise }) => {
      const [searchQuery, setSearchQuery] = useState('');
      const [selectedCategory, setSelectedCategory] = useState('All');

      const categories = ['All', 'Push', 'Pull', 'Legs', 'Core', 'Full Body'];

      const filteredExercises = exercises.filter((exercise) => {
        const matchesSearch = exercise.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                             exercise.equipment.toLowerCase().includes(searchQuery.toLowerCase()) ||
                             exercise.muscleGroups.some(m => m.toLowerCase().includes(searchQuery.toLowerCase()));

        const matchesCategory = selectedCategory === 'All' || exercise.category === selectedCategory;

        return matchesSearch && matchesCategory;
      });

      const handleSelect = (exercise) => {
        onSelectExercise(exercise);
        onClose();
        if ('vibrate' in navigator) {
          navigator.vibrate(10);
        }
      };

      if (!isOpen) return null;

      return (
        <>
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="drawer-overlay"
            onClick={onClose}
          />
          <motion.div
            initial={{ y: '100%' }}
            animate={{ y: 0 }}
            exit={{ y: '100%' }}
            transition={{ type: "spring", stiffness: 300, damping: 30 }}
            className="drawer-content"
          >
            <div className="flex flex-col h-full">
              <div className="flex justify-center py-3 flex-shrink-0">
                <div className="w-12 h-1.5 rounded-full bg-gray-300" />
              </div>

              <div className="px-6 pb-4 flex-shrink-0">
                <h2 className="font-bold text-3xl text-gray-900 mb-4">
                  Add Exercise
                </h2>

                <div className="relative mb-4">
                  <input
                    type="text"
                    placeholder="Search exercises..."
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    className="w-full px-4 py-3 pl-11 bg-gray-100 rounded-xl border-2 border-transparent focus:border-blue-500 focus:outline-none transition-colors text-base"
                  />
                  <svg
                    className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                  </svg>
                </div>

                <div className="flex gap-2 overflow-x-auto pb-2 -mx-1 px-1">
                  {categories.map((category) => (
                    <motion.button
                      key={category}
                      whileTap={{ scale: 0.95 }}
                      onClick={() => {
                        setSelectedCategory(category);
                        if ('vibrate' in navigator) navigator.vibrate(10);
                      }}
                      className={`px-4 py-2 rounded-lg font-semibold text-sm whitespace-nowrap transition-all ${
                        selectedCategory === category
                          ? 'bg-blue-600 text-white shadow-md'
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                    >
                      {category}
                    </motion.button>
                  ))}
                </div>
              </div>

              <div className="flex-1 overflow-y-auto px-6 pb-6">
                <AnimatePresence mode="wait">
                  {filteredExercises.length === 0 ? (
                    <motion.div
                      initial={{ opacity: 0 }}
                      animate={{ opacity: 1 }}
                      exit={{ opacity: 0 }}
                      className="flex flex-col items-center justify-center py-12"
                    >
                      <div className="w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4">
                        <svg className="w-8 h-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                      </div>
                      <p className="text-gray-500 text-center">
                        No exercises found.<br />
                        <span className="text-sm">Try a different search or category.</span>
                      </p>
                    </motion.div>
                  ) : (
                    <div className="space-y-2">
                      {filteredExercises.map((exercise, index) => (
                        <motion.button
                          key={exercise.id}
                          initial={{ opacity: 0, x: -20 }}
                          animate={{ opacity: 1, x: 0 }}
                          exit={{ opacity: 0, x: 20 }}
                          transition={{
                            delay: index * 0.02,
                            type: "spring",
                            stiffness: 300,
                            damping: 30
                          }}
                          whileTap={{ scale: 0.98 }}
                          onClick={() => handleSelect(exercise)}
                          className="w-full p-4 bg-white hover:bg-gray-50 rounded-xl text-left border-2 border-gray-100 hover:border-blue-300 transition-all group"
                        >
                          <div className="flex items-center justify-between">
                            <div className="flex-1">
                              <h4 className="text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors">
                                {exercise.name}
                              </h4>
                              <div className="flex items-center gap-2 mt-1">
                                <span className="px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-semibold rounded">
                                  {exercise.equipment}
                                </span>
                                {exercise.muscleGroups.slice(0, 2).map((muscle, idx) => (
                                  <span key={idx} className="text-xs text-gray-500">
                                    {muscle}
                                  </span>
                                ))}
                              </div>
                            </div>
                            <svg
                              className="w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors"
                              fill="none"
                              viewBox="0 0 24 24"
                              stroke="currentColor"
                            >
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                            </svg>
                          </div>
                        </motion.button>
                      ))}
                    </div>
                  )}
                </AnimatePresence>
              </div>
            </div>
          </motion.div>
        </>
      );
    };

    // ==================== MAIN WORKOUT BUILDER ====================
    const WorkoutBuilder = () => {
      const [exercises, setExercises] = useState(mockWorkout);
      const [isPickerOpen, setIsPickerOpen] = useState(false);
      const [restTimer, setRestTimer] = useState(null);

      const handleUpdateSet = useCallback((exerciseId, setId, field, value) => {
        setExercises((prev) =>
          prev.map((ex) =>
            ex.id === exerciseId
              ? {
                  ...ex,
                  sets: ex.sets.map((set) =>
                    set.id === setId ? { ...set, [field]: value } : set
                  ),
                }
              : ex
          )
        );
      }, []);

      const handleLogSet = useCallback((exerciseId, setId) => {
        setExercises((prev) =>
          prev.map((ex) =>
            ex.id === exerciseId
              ? {
                  ...ex,
                  sets: ex.sets.map((set) =>
                    set.id === setId ? { ...set, completed: true } : set
                  ),
                }
              : ex
          )
        );

        const exercise = exercises.find((ex) => ex.id === exerciseId);
        if (exercise) {
          setRestTimer({ active: true, seconds: exercise.restTimerSeconds });
        }

        if ('vibrate' in navigator) {
          navigator.vibrate([50, 25, 50]);
        }
      }, [exercises]);

      const handleLogAllRemaining = useCallback((exerciseId) => {
        const exercise = exercises.find((ex) => ex.id === exerciseId);
        if (!exercise) return;

        const completedSets = exercise.sets.filter((s) => s.completed);
        if (completedSets.length === 0) return;

        const lastCompleted = completedSets[completedSets.length - 1];
        const remainingSets = exercise.sets.filter((s) => !s.completed);

        setExercises((prev) =>
          prev.map((ex) =>
            ex.id === exerciseId
              ? {
                  ...ex,
                  sets: ex.sets.map((set) =>
                    remainingSets.some((rs) => rs.id === set.id)
                      ? {
                          ...set,
                          weight: lastCompleted.weight,
                          reps: lastCompleted.reps,
                          completed: true,
                        }
                      : set
                  ),
                }
              : ex
          )
        );

        if ('vibrate' in navigator) {
          navigator.vibrate([100, 50, 100]);
        }
      }, [exercises]);

      const handleAddExercise = useCallback((exercise) => {
        const newExercise = {
          id: `ex-${Date.now()}`,
          name: exercise.name,
          equipment: exercise.equipment,
          muscleGroups: exercise.muscleGroups,
          restTimerSeconds: 90,
          sets: [
            { id: `set-${Date.now()}-1`, reps: 10, weight: 0, completed: false, toFailure: false },
            { id: `set-${Date.now()}-2`, reps: 10, weight: 0, completed: false, toFailure: false },
            { id: `set-${Date.now()}-3`, reps: 10, weight: 0, completed: false, toFailure: false },
          ],
        };
        setExercises((prev) => [...prev, newExercise]);
      }, []);

      const handleSkipRest = useCallback(() => {
        setRestTimer(null);
      }, []);

      const handleRestComplete = useCallback(() => {
        setRestTimer(null);
        if ('vibrate' in navigator) {
          navigator.vibrate([100, 50, 100]);
        }
      }, []);

      const totalSets = exercises.reduce((acc, ex) => acc + ex.sets.length, 0);
      const completedSets = exercises.reduce(
        (acc, ex) => acc + ex.sets.filter((s) => s.completed).length,
        0
      );

      return (
        <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 pb-24">
          {restTimer && restTimer.active && (
            <RestTimer
              initialSeconds={restTimer.seconds}
              onComplete={handleRestComplete}
              onSkip={handleSkipRest}
            />
          )}

          <div className="sticky top-0 bg-white shadow-md z-30 px-6 py-4">
            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-3xl font-bold text-gray-900">FitForge UX Mockup</h1>
                <p className="text-sm text-gray-600 mt-1">
                  Modern Workout Builder Demo
                </p>
              </div>
              <div className="text-right">
                <div className="text-3xl font-bold text-blue-600">
                  {completedSets}/{totalSets}
                </div>
                <div className="text-xs text-gray-500 uppercase tracking-wide">
                  Sets Done
                </div>
              </div>
            </div>
          </div>

          <div className="px-4 pt-6">
            <AnimatePresence>
              {exercises.map((exercise) => {
                const completedCount = exercise.sets.filter((s) => s.completed).length;
                const totalCount = exercise.sets.length;
                const showLogAllButton =
                  (totalCount === 3 && completedCount === 2) ||
                  (totalCount === 4 && completedCount === 3);

                return (
                  <ExerciseCard
                    key={exercise.id}
                    exercise={exercise}
                    onUpdateSet={(setId, field, value) =>
                      handleUpdateSet(exercise.id, setId, field, value)
                    }
                    onLogSet={(setId) => handleLogSet(exercise.id, setId)}
                    showLogAllButton={showLogAllButton}
                    onLogAll={() => handleLogAllRemaining(exercise.id)}
                  />
                );
              })}
            </AnimatePresence>
          </div>

          {exercises.length === 0 && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              className="flex flex-col items-center justify-center py-20"
            >
              <div className="w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mb-4">
                <svg
                  className="w-10 h-10 text-blue-600"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M12 4v16m8-8H4"
                  />
                </svg>
              </div>
              <h3 className="text-xl font-semibold text-gray-900 mb-2">
                No Exercises Yet
              </h3>
              <p className="text-gray-600 text-center">
                Tap the button below to add your first exercise
              </p>
            </motion.div>
          )}

          <motion.button
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ delay: 0.3, type: 'spring', stiffness: 300, damping: 25 }}
            whileTap={{ scale: 0.9 }}
            onClick={() => setIsPickerOpen(true)}
            className="fixed bottom-6 right-6 w-16 h-16 bg-blue-600 hover:bg-blue-700 rounded-full shadow-2xl flex items-center justify-center z-40 transition-colors"
            style={{ boxShadow: '0 10px 40px rgba(37, 99, 235, 0.4)' }}
          >
            <svg
              className="w-8 h-8 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2.5}
                d="M12 4v16m8-8H4"
              />
            </svg>
          </motion.button>

          <AnimatePresence>
            {isPickerOpen && (
              <ExercisePicker
                isOpen={isPickerOpen}
                onClose={() => setIsPickerOpen(false)}
                exercises={exerciseLibrary}
                onSelectExercise={handleAddExercise}
              />
            )}
          </AnimatePresence>
        </div>
      );
    };

    // ==================== RENDER APP ====================
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<WorkoutBuilder />);
  </script>
</body>
</html>
